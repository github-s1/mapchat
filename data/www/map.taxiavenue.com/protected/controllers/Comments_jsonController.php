<?phpclass Comments_jsonController extends Controller{    public $layout='//layouts/none';        public function accessRules()    {        return array(            array('allow',  // allow all users to perform 'index' and 'view' actions                'actions'=>array('GetCommentsByMarkId'),                'users'=>array('*'),            ),            array('allow', // allow authenticated user to perform 'create' and 'update' actions                'actions'=>array('AddComment'),                'users'=>array('@'),            ),            array('allow', // allow admin user to perform 'admin' and 'delete' actions                'actions'=>array(),                'users'=>array('admin'),            ),            array('deny',  // deny all users                'users'=>array('*'),            ),        );    }        public function actionAddComment()    {        $id_mark = Yii::app()->request->getPost('id_mark');        $text = Yii::app()->request->getPost('text');        $hash = Yii::app()->request->getPost('hash');        //        $id_mark = $_GET['id_mark'];//        $id_user = $_GET['id_user'];//        $text = $_GET['text'];        $add = new addData;        if(!$hash) {            $hash = Yii::app()->request->getPost('id_user');            $result = $add->addComment2($id_mark, $text, $hash);        } else {            $result = $add->addComment($id_mark, $text, $hash);        }        $res = array('response'=>$result);        $res_encode=json_encode($res);        $this->render('addComment',array(            'data'=>$res_encode        ));    }        public function actionAddCommentWeb()    {        $id_mark = Yii::app()->request->getPost('id_mark');        $text = Yii::app()->request->getPost('text');        $text = str_replace("&nbsp;", " ", $text);        if(trim($text) == '') die();        $add = new addData;        $result = $add->addCommentWeb($id_mark, $text);        $res = array('response'=>$result);        $this->renderJSON($res);    }        public function actionGetCommentsByMarkId(){        $id_mark = Yii::app()->request->getPost('id_mark');       // $id_mark = $_GET['id_mark'];        if (isset($id_mark)){            $result = $this->GetCommentsByMarkId($id_mark);        }        else            $result = 'false';        $res = array('response'=>$result);        $res_encode=json_encode($res);        $this->render('getCommentsByMarkId',array(            'data'=>$res_encode        ));    }}